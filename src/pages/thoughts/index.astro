---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/Layout.astro';
import TerminalWindow from '@components/TerminalWindow.astro';

const thoughts = await getCollection('thoughts');

// Group by mood if available
const byMood: Record<string, typeof thoughts> = {
  'technical': [],
  'reflective': [],
  'philosophical': [],
  'personal': [],
  'uncategorized': []
};

thoughts.forEach(t => {
  const mood = t.data.mood || 'uncategorized';
  if (!byMood[mood]) byMood[mood] = [];
  byMood[mood].push(t);
});

const moodConfig = {
  'technical': { label: 'Technical', icon: '‚öôÔ∏è', color: 'text-blue-400' },
  'reflective': { label: 'Reflective', icon: 'üí≠', color: 'text-purple-400' },
  'philosophical': { label: 'Philosophical', icon: 'üß†', color: 'text-yellow-400' },
  'personal': { label: 'Personal', icon: '‚úçÔ∏è', color: 'text-green-400' },
  'uncategorized': { label: 'Miscellaneous', icon: 'üìù', color: 'text-gray-400' }
};
---

<BaseLayout title="Thoughts | Genix">
  <TerminalWindow command="ls thoughts">
    <div class="space-y-10">
      <!-- Header -->
      <div class="space-y-2 pb-6 border-b border-gray-800">
        <h1 class="text-2xl text-white font-bold">Thoughts</h1>
        <p class="text-base text-gray-300 leading-relaxed">
          Personal reflections on code, systems, learning, and the philosophy of building software.
        </p>
      </div>

      <!-- Thoughts by Mood -->
      {Object.entries(byMood)
        .filter(([_, items]) => items.length > 0)
        .map(([mood, items]) => {
          const config = moodConfig[mood as keyof typeof moodConfig];
          return (
            <div class="space-y-5">
              <div class="flex items-baseline gap-3 pb-3 border-b border-gray-900">
                <span class="text-gray-600">‚ñ∂</span>
                <span class="text-base">{config.icon}</span>
                <h2 class="text-lg text-gray-200 font-semibold">
                  {config.label}
                </h2>
                <span class="text-sm text-gray-600">({items.length})</span>
              </div>
              
              <div class="space-y-6">
                {items.map((thought, idx) => (
                  <article 
                    class="group space-y-2 animate-fade-in"
                    style={`animation-delay: ${idx * 50}ms`}>
                    <a href={`/thoughts/${thought.slug}`} class="block space-y-2">
                      <h3 class="text-lg text-gray-100 group-hover:text-white transition-colors font-medium">
                        {thought.data.title}
                      </h3>
                      
                      {thought.data.description && (
                        <p class="text-base text-gray-300 leading-relaxed">
                          {thought.data.description}
                        </p>
                      )}
                    </a>
                    
                    {thought.data.tags.length > 0 && (
                      <div class="flex flex-wrap gap-2 pt-1">
                        {thought.data.tags.map(tag => (
                          <span class="text-xs text-gray-400 bg-gray-950 px-2 py-0.5 rounded border border-gray-900">
                            {tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </article>
                ))}
              </div>
            </div>
          );
        })
      }

      {thoughts.length === 0 && (
        <div class="text-center py-16">
          <p class="text-gray-400">No thoughts yet.</p>
        </div>
      )}

      <!-- Footer Note -->
      <div class="pt-6 border-t border-gray-900">
        <p class="text-sm text-gray-400">
          Raw, unpolished thinking about projects, learning experiences, and the craft of software development.
        </p>
      </div>
    </div>
  </TerminalWindow>
</BaseLayout>

<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fade-in {
    animation: fade-in 0.5s ease-out forwards;
    opacity: 0;
  }
</style>